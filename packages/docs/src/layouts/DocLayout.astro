---
import BaseLayout from './BaseLayout.astro'
import { NavigationBar } from './NavigationBar'
import type { NavigationBarItem } from './NavigationBar'
import { basename } from 'path'
import { GScrollbar } from '@lingjhf/guava'

function urlToNav(url: string) {
  return {
    title:
      basename(url)
        ?.replace(/(\w)/, (a: string) => a.toUpperCase())
        ?.replaceAll('-', ' ') ?? '',
    url: `${url}/`,
  }
}
const gettingStartedPosts = await Astro.glob('../pages/getting-started/*.astro')
const componentsPosts = await Astro.glob('../pages/components/*.astro')

const navItems = [
  {
    title: 'Getting started',
    children: gettingStartedPosts.map((item) => urlToNav(item.url!)),
  },
  {
    title: 'Components',
    children: componentsPosts.map((item) => urlToNav(item.url!)),
  },
] as NavigationBarItem[]

const pathname = Astro.url.pathname
---

<BaseLayout pageTitle={''}>
  <div class="flex absolute inset-0">
    <div class="w-300px h-full bg-[var(--bg-common-highest)]">
      <NavigationBar client:only="solid-js" value={pathname} items={navItems} />
    </div>
    <div class="h-full w-full">
      <GScrollbar client:only="solid-js">
        <div class="p-32px">
          <slot />
        </div>
      </GScrollbar>
    </div>
  </div>
</BaseLayout>
